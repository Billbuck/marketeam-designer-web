procédure GenereWindowsDevMode(sOrientation est une chaîne, pHauteurMM est un réel, pLargeurMM est un réel) : chaîne

nOctetFaible		est un entier
nOctetFort			est un entier
sHexaOrientation	est une chaîne
sHexaHauteur		est une chaîne
sHexaLargeur		est une chaîne

// Orientation : 1 = Portrait, 2 = Paysage
nOrientation	est un entier
si Majuscule(sOrientation) = "PAYSAGE" ou Majuscule(sOrientation) = "LANDSCAPE" alors
	nOrientation = 2
sinon
	nOrientation = 1
fin

// Écrire l'orientation
nOctetFaible		= modulo(nOrientation, 256)
nOctetFort			= nOrientation / 256
sHexaOrientation	= Droite("0" + EntierVersHexa(nOctetFaible), 2) + Droite("0" + EntierVersHexa(nOctetFort), 2)

// Écrire la hauteur en 1/10 mm
nHauteur est un entier = Arrondi(pHauteurMM * 10)
nOctetFaible		= modulo(nHauteur, 256)
nOctetFort			= nHauteur / 256
sHexaHauteur		= Droite("0" + EntierVersHexa(nOctetFaible), 2) + Droite("0" + EntierVersHexa(nOctetFort), 2)

// Écrire la largeur en 1/10 mm
nLargeur est un entier = Arrondi(pLargeurMM * 10)
nOctetFaible		= modulo(nLargeur, 256)
nOctetFort			= nLargeur / 256
sHexaLargeur		= Droite("0" + EntierVersHexa(nOctetFaible), 2) + Droite("0" + EntierVersHexa(nOctetFort), 2)

// Template DEVMODE en hexadécimal (1211 octets)
sHex est une chaîne =
[
FFFEFF165000720069006E007400530068006F00700020004D00610069006C00200050007200
69006E00740065007200780400005000720069006E007400530068006F00700020004D006100
69006C0020005000720069006E007400650072000000000000000000000000000000000000000
0000001040006DC009C0353EF80[%sHexaOrientation%]00FF[%sHexaHauteur%][%sHexaLargeur%]04640001000F00480002000100480003
0001000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000001000000000000000100000002000000010000000000000000000000000000000
00000000000000050524956E230000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000001800000000001027102710270000102700
00000000000000C8009C030000000000000000000000000000000000000000000000000300000
0000000000000100050BD0100887E0300000000000000000000000000000000000000000000
00000000000000449F6BE60500000000002500FF00FF000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000001000000000000000000000000000
000C8000000534D544A000000001000B8005000720069006E007400530068006F00700020004
D00610069006C0020005000720069006E00740065007200200044007200690076006500720020
00280050005300290000005265736F6C7574696F6E003732647069005061676553697A6500437
573746F6D5061676553697A650050616765526567696F6E00004C656164696E6745646765000
0496E707574536C6F74002A557365466F726D547261795461626C6500000000000000000000
0000000000000000000000
]

sHex = Remplace(sHex,RC,"")

// Convertir hexa en buffer puis en Base64
bufDevmode	est un Buffer	= HexaVersBuffer(sHex)
sBase64		est une chaîne	= Encode(bufDevmode, encodeBASE64)

renvoyer sBase64
